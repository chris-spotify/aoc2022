const input = ['>','>','>','>','<','<','<','<','>','>','>','<','<','>','>','>','<','<','<','<','>','>','<','<','>','>','>','>','<','>','<','>','<','>','<','<','<','<','>','<','<','>','>','>','>','<','<','<','<','>','>','>','<','>','<','<','>','<','<','>','>','>','>','<','<','>','>','>','>','<','>','<','<','>','>','>','<','>','>','>','<','<','<','<','>','>','>','<','<','<','>','<','<','<','<','>','>','>','<','<','<','<','>','>','>','>','<','<','<','<','>','>','<','<','<','<','>','<','<','<','<','>','>','<','<','>','>','>','<','>','>','>','>','<','>','>','>','<','<','>','>','>','<','<','<','<','>','>','>','<','>','>','<','<','<','>','<','>','>','>','<','>','>','>','>','<','>','<','<','<','<','>','>','>','<','<','>','>','>','<','<','>','<','<','<','<','>','>','>','<','<','<','<','>','>','<','>','>','<','<','>','>','>','>','<','<','>','<','>','>','>','>','<','<','>','>','<','<','>','<','>','>','>','<','>','>','>','<','<','<','<','>','<','<','>','>','<','<','<','>','>','<','<','>','>','>','<','<','<','<','>','>','>','>','<','>','>','>','>','<','<','<','>','>','<','<','<','>','<','<','<','<','>','>','>','<','>','>','<','<','<','>','>','>','>','<','>','<','<','<','<','>','>','<','<','>','<','<','>','>','>','>','<','<','>','>','<','<','>','<','<','>','>','>','<','>','<','<','<','>','<','<','>','>','<','>','<','>','>','>','<','<','<','<','>','>','<','<','<','<','>','>','>','>','<','<','<','<','>','>','>','>','<','<','<','<','>','>','>','>','<','<','<','<','>','>','>','<','>','>','<','<','>','>','>','>','<','>','>','>','<','<','>','>','>','<','<','>','>','>','<','<','<','>','>','>','>','<','<','<','<','>','>','<','<','<','>','<','>','>','<','<','<','>','<','<','<','<','>','<','>','<','<','<','>','>','<','<','>','<','>','>','>','>','<','<','>','>','>','>','<','<','<','>','>','>','<','<','<','>','>','>','>','<','>','>','>','<','<','>','<','<','<','>','<','<','<','<','>','<','<','<','>','>','>','<','<','<','<','>','>','<','<','>','>','>','<','<','>','<','>','>','<','>','>','>','<','>','>','>','>','<','<','>','>','>','<','<','<','>','>','>','>','<','<','<','<','>','>','>','>','<','>','>','<','<','<','<','>','<','>','>','<','<','>','>','>','>','<','<','<','<','>','>','>','<','<','<','>','<','<','>','<','<','>','>','>','<','<','>','<','>','>','>','<','>','>','>','>','<','>','>','>','<','<','<','>','>','>','>','<','<','<','<','>','>','>','>','<','>','>','>','<','<','<','>','>','>','>','<','<','<','<','>','>','>','>','<','<','<','<','>','<','>','>','>','<','>','>','<','<','<','<','>','>','>','>','<','<','<','>','>','>','<','<','<','<','>','>','<','>','>','>','>','<','<','<','<','>','<','<','<','<','>','>','<','<','<','>','<','<','<','<','>','>','<','>','>','<','<','>','<','<','<','<','>','>','>','<','>','>','>','>','<','<','<','<','>','>','>','<','>','>','>','<','<','<','>','<','<','>','<','<','>','>','<','<','<','<','>','>','<','<','>','>','<','<','>','<','<','<','>','<','<','<','<','>','>','<','<','<','<','>','>','<','<','<','>','>','>','<','<','<','<','>','>','>','>','<','<','<','<','>','>','>','>','<','>','>','<','<','<','>','>','>','<','<','<','>','>','<','<','<','<','>','>','>','>','<','<','>','>','>','<','>','>','>','>','<','<','<','>','>','>','>','<','>','>','<','<','<','<','>','>','<','>','>','>','<','<','<','>','>','<','<','<','<','>','>','>','>','<','>','>','>','<','<','>','<','<','>','>','<','<','<','>','>','<','<','<','<','>','>','>','>','<','>','<','<','<','<','>','>','>','<','>','>','<','>','>','>','<','<','<','<','>','>','>','<','>','>','<','<','<','<','>','>','>','>','<','>','>','<','<','>','>','<','<','<','>','>','>','>','<','<','>','>','>','<','<','<','>','>','>','>','<','>','<','>','>','<','<','>','>','<','<','<','>','>','>','>','<','<','<','>','>','<','>','>','<','>','>','>','<','<','<','<','>','>','>','<','<','<','<','>','>','>','<','>','<','<','>','>','<','<','>','>','>','>','<','<','<','>','<','<','>','>','>','<','>','>','<','>','>','<','<','<','>','>','<','<','<','<','>','>','<','<','<','<','>','>','>','>','<','<','>','>','<','>','<','<','<','>','>','>','>','<','<','>','<','>','<','>','>','>','>','<','>','>','<','<','>','>','<','<','>','>','<','<','>','>','<','<','>','>','<','>','>','>','>','<','<','>','>','>','<','<','<','<','>','<','>','<','<','>','<','<','>','>','<','<','>','<','<','>','>','>','<','<','<','<','>','>','<','<','>','>','>','<','<','<','<','>','>','>','<','<','<','<','>','>','>','<','>','>','>','<','>','>','>','<','>','<','<','<','<','>','<','>','<','>','>','>','>','<','>','>','>','>','<','<','<','>','>','>','<','<','<','<','>','>','<','<','<','<','>','>','<','<','<','>','>','>','>','<','>','>','>','<','<','<','<','>','>','<','>','>','>','>','<','<','>','>','>','>','<','<','>','>','>','>','<','>','>','>','<','<','<','<','>','<','>','>','<','<','<','<','>','>','<','<','<','<','>','>','>','>','<','>','>','<','>','<','<','<','<','>','>','>','<','>','>','>','>','<','<','>','>','>','<','<','>','>','>','<','<','>','>','<','<','<','>','>','<','<','<','<','>','>','>','>','<','<','<','>','>','<','<','>','<','<','>','>','>','<','<','<','>','<','<','<','<','>','>','>','<','<','<','<','>','<','>','>','>','>','<','>','>','<','>','>','>','>','<','<','<','<','>','>','>','>','<','<','>','>','<','<','<','<','>','>','>','<','<','>','>','<','<','<','>','>','<','<','>','<','>','>','<','<','>','>','<','>','<','<','<','<','>','>','>','<','<','<','<','>','>','<','>','>','<','<','>','>','<','<','>','>','<','<','>','>','<','>','>','<','<','>','<','<','>','>','>','>','<','<','>','>','>','<','>','>','>','<','>','>','>','>','<','<','<','>','>','<','<','>','<','<','<','>','<','>','>','>','<','<','<','>','<','>','<','>','>','>','<','<','<','<','>','>','>','>','<','<','<','<','>','>','>','>','<','<','>','<','<','<','<','>','>','<','<','<','<','>','<','<','>','<','<','<','>','>','>','<','<','<','<','>','>','>','>','<','<','>','>','>','>','<','<','>','<','<','>','>','>','<','<','<','<','>','>','>','<','<','<','<','>','<','<','<','>','<','>','>','>','<','<','>','>','<','<','<','<','>','>','>','<','<','<','>','<','<','<','<','>','>','>','>','<','<','>','>','>','<','<','<','>','<','<','<','<','>','>','>','>','<','>','>','>','>','<','<','<','<','>','<','<','>','>','<','<','>','>','>','<','<','>','>','>','>','<','<','>','>','<','<','>','<','<','<','<','>','>','>','<','<','>','>','>','<','<','<','>','>','>','<','<','<','>','>','<','<','<','<','>','>','>','>','<','<','>','>','>','>','<','<','>','>','>','>','<','>','>','>','<','<','<','>','>','>','<','<','>','>','<','>','<','<','<','>','>','>','>','<','<','<','<','>','<','<','<','>','>','>','>','<','>','<','<','>','>','>','<','>','>','<','<','>','>','<','>','>','<','>','>','>','>','<','>','<','<','<','>','<','>','<','<','>','>','<','>','>','>','>','<','<','<','<','>','>','<','<','<','<','>','>','>','<','<','<','>','<','<','<','<','>','>','>','<','>','<','<','<','<','>','>','>','>','<','<','>','<','<','<','<','>','<','<','<','<','>','>','>','<','<','<','<','>','<','<','<','>','>','<','<','<','>','>','<','>','>','>','<','<','>','>','>','>','<','<','<','>','>','>','<','>','>','>','>','<','<','>','<','>','>','>','>','<','<','<','>','>','>','<','>','>','>','>','<','<','<','>','>','<','<','>','>','>','>','<','<','<','<','>','>','>','<','<','<','<','>','>','>','>','<','<','<','>','<','<','<','<','>','>','>','<','<','<','<','>','>','>','>','<','>','>','>','>','<','<','<','<','>','>','<','<','<','>','>','>','<','<','>','>','<','<','<','>','<','<','<','>','>','>','>','<','<','>','>','<','<','<','<','>','>','>','<','<','<','>','>','>','<','<','<','<','>','>','>','>','<','>','<','<','>','>','<','>','>','<','<','<','>','>','<','>','>','>','<','<','>','>','<','<','<','<','>','>','>','>','<','<','<','<','>','>','<','<','>','>','>','>','<','<','<','>','<','>','>','<','>','>','<','>','>','>','<','<','<','>','>','>','>','<','<','>','>','>','>','<','<','>','>','>','<','>','>','>','<','<','<','<','>','>','>','<','>','>','>','<','<','>','>','>','<','<','<','>','>','>','>','<','<','>','>','>','>','<','>','>','>','<','<','>','>','>','<','<','<','>','>','>','<','<','<','>','<','<','<','>','<','<','<','<','>','>','>','<','>','>','>','>','<','<','<','>','>','>','<','<','<','<','>','<','<','<','<','>','>','>','<','<','<','>','>','>','>','<','>','<','<','<','<','>','>','<','<','>','>','>','>','<','<','<','>','<','<','<','<','>','>','>','<','>','>','>','>','<','<','<','<','>','<','<','<','<','>','<','<','<','<','>','<','>','<','<','<','<','>','>','>','<','<','<','>','>','>','<','<','<','<','>','>','<','>','>','<','>','>','<','<','>','>','>','<','<','>','>','<','<','<','<','>','>','>','>','<','<','<','<','>','>','>','<','<','<','>','<','<','>','>','>','<','<','<','<','>','>','>','>','<','>','<','<','<','>','<','<','>','<','<','>','>','<','<','<','<','>','<','<','>','>','>','<','<','>','>','>','<','<','>','<','<','<','<','>','>','>','<','<','<','<','>','>','<','>','>','>','>','<','<','<','>','>','<','<','>','>','>','<','>','>','<','<','>','>','>','>','<','<','>','<','<','<','>','>','>','>','<','<','>','>','>','>','<','>','>','>','<','<','>','>','>','>','<','<','<','<','>','>','>','<','<','<','<','>','>','>','<','<','<','>','>','<','<','<','>','<','<','<','>','<','<','<','>','>','>','>','<','<','>','>','<','<','<','<','>','>','>','>','<','>','>','<','>','<','>','>','>','>','<','<','<','<','>','>','<','<','<','>','<','<','<','>','>','<','<','>','>','>','>','<','<','<','<','>','>','>','>','<','>','>','>','<','<','<','>','>','<','<','<','>','>','<','<','>','>','<','<','<','<','>','>','>','>','<','>','>','<','<','<','<','>','>','>','<','>','<','<','>','>','>','>','<','<','<','>','>','>','<','<','>','>','>','>','<','<','<','>','<','<','>','>','<','>','>','>','>','<','<','<','>','>','<','<','<','<','>','<','<','<','<','>','>','>','<','<','<','>','>','>','<','>','<','>','<','<','<','>','<','>','>','>','<','<','<','>','>','>','<','<','>','>','>','<','<','>','<','<','>','<','>','>','>','<','<','<','>','>','<','<','>','>','>','<','<','<','<','>','>','>','>','<','<','<','<','>','>','<','>','>','>','<','>','>','<','>','>','>','<','>','>','>','<','>','>','<','<','>','>','>','<','<','>','<','<','<','>','>','>','<','>','>','>','<','<','>','>','<','<','<','<','>','>','<','>','>','>','>','<','<','<','>','<','>','<','<','<','<','>','>','>','>','<','<','<','>','<','<','<','>','>','>','<','<','<','<','>','>','<','<','<','>','>','<','>','>','<','<','>','>','<','<','<','>','>','>','<','<','<','<','>','<','<','<','<','>','>','<','<','<','>','>','<','>','>','>','>','<','<','<','<','>','>','>','<','<','>','<','<','<','>','>','>','<','<','>','>','<','<','>','<','>','<','<','<','<','>','>','>','<','<','<','<','>','>','>','<','<','<','>','>','>','<','<','<','<','>','>','<','<','>','>','<','<','>','>','>','>','<','<','<','<','>','>','>','>','<','>','<','<','<','<','>','<','<','<','<','>','>','>','<','<','>','>','>','<','<','<','<','>','<','<','<','>','>','<','<','<','>','>','>','<','<','>','>','>','<','<','<','<','>','>','>','<','>','<','<','>','>','>','<','<','<','<','>','<','<','>','<','<','<','<','>','>','>','<','<','>','>','>','>','<','<','<','>','<','<','>','>','>','<','>','<','<','>','>','>','>','<','<','<','<','>','>','>','>','<','<','<','>','>','>','>','<','<','<','<','>','>','>','<','<','<','>','>','>','>','<','<','<','>','>','>','<','<','<','>','<','<','<','<','>','>','>','<','<','>','>','<','<','>','>','>','>','<','<','<','>','<','<','>','>','>','<','<','>','<','<','<','>','>','>','>','<','>','>','<','<','<','>','>','<','<','<','<','>','>','>','>','<','<','>','>','>','<','<','<','<','>','<','<','<','<','>','>','<','<','>','<','>','>','<','<','<','<','>','>','>','<','<','<','>','>','<','>','>','>','>','<','<','<','<','>','>','<','<','>','>','<','<','>','>','>','>','<','<','<','>','<','>','>','>','>','<','<','<','>','<','<','<','<','>','<','>','>','>','>','<','<','>','>','>','<','<','>','>','<','<','<','>','>','>','>','<','<','>','>','>','<','<','<','>','>','<','<','>','>','>','<','>','>','<','<','>','>','<','>','>','>','<','<','<','<','>','>','>','>','<','<','<','>','>','>','<','>','>','>','<','<','>','>','>','<','>','>','>','<','<','<','>','<','>','<','<','<','>','>','>','<','<','>','>','<','<','>','<','>','>','>','>','<','<','<','>','>','>','<','<','<','<','>','<','<','>','>','>','<','<','<','<','>','>','>','<','<','<','>','>','>','>','<','<','>','<','>','>','>','>','<','<','>','>','<','>','>','>','<','<','>','>','<','>','>','<','<','<','>','>','>','>','<','>','>','>','<','<','<','<','>','>','>','<','>','>','>','<','<','<','>','>','<','<','<','>','>','>','>','<','<','<','>','>','>','<','<','<','>','<','<','<','>','<','<','<','<','>','<','<','<','<','>','>','>','<','<','<','<','>','>','<','<','<','<','>','>','<','<','<','<','>','>','>','>','<','<','<','<','>','>','>','<','>','<','>','<','<','>','<','<','<','<','>','<','>','>','>','>','<','<','<','<','>','>','>','<','<','<','>','<','<','<','>','>','<','>','>','>','<','>','<','<','>','>','<','>','>','>','>','<','<','<','<','>','>','<','<','<','>','>','>','<','<','<','<','>','>','>','<','<','<','>','>','>','<','>','>','>','>','<','>','<','<','<','<','>','>','>','<','<','<','>','>','>','>','<','<','<','>','>','<','<','<','<','>','>','>','>','<','<','<','>','>','<','<','<','>','>','<','<','<','>','>','>','<','<','>','>','>','>','<','<','>','>','<','>','>','>','>','<','<','<','<','>','>','>','<','<','<','<','>','>','<','>','>','>','<','<','<','>','>','<','>','<','<','<','>','>','<','<','<','<','>','>','>','>','<','>','>','>','>','<','<','<','>','<','<','>','<','>','<','<','>','>','<','<','>','<','>','>','<','<','<','>','>','>','>','<','<','>','<','<','<','>','>','<','<','>','>','>','<','<','>','<','<','>','>','<','<','<','>','>','>','<','<','>','<','<','<','>','<','<','<','>','>','<','<','>','<','>','>','>','>','<','>','<','<','<','<','>','<','<','<','<','>','>','<','<','<','>','>','>','<','<','<','<','>','>','>','<','<','<','<','>','>','<','<','<','>','<','<','<','>','>','<','>','<','<','<','>','>','>','<','<','<','<','>','>','>','<','>','>','>','<','<','<','<','>','>','>','<','<','>','>','>','>','<','<','<','<','>','>','<','<','>','>','>','<','<','>','>','<','>','>','>','>','<','<','<','<','>','>','<','<','<','<','>','>','<','<','<','>','>','>','>','<','<','<','>','>','>','>','<','<','>','<','<','<','>','<','<','>','>','>','<','<','>','>','<','<','<','<','>','>','>','>','<','<','>','<','>','>','<','>','>','>','<','>','<','<','>','<','<','>','<','>','>','>','>','<','<','<','<','>','<','<','<','>','>','>','>','<','<','>','>','>','<','<','<','>','>','>','>','<','<','<','>','<','<','>','>','<','<','<','<','>','>','>','>','<','<','<','<','>','>','<','<','<','<','>','>','>','<','<','>','<','<','>','<','<','<','<','>','>','>','<','<','<','<','>','>','>','<','<','<','>','>','<','<','>','>','>','<','<','<','<','>','<','>','<','<','<','<','>','<','<','>','<','<','<','<','>','>','>','<','<','>','>','>','<','<','<','>','>','>','>','<','<','>','<','<','<','>','>','>','>','<','<','<','<','>','>','>','>','<','<','<','<','>','>','<','<','<','<','>','>','>','>','<','<','>','>','>','>','<','>','>','>','>','<','>','>','<','<','<','<','>','>','<','>','>','>','>','<','>','>','>','>','<','>','>','>','>','<','<','<','>','>','>','<','<','<','<','>','>','>','<','>','>','<','>','>','>','<','<','>','>','>','>','<','<','<','>','>','>','>','<','<','<','<','>','<','<','<','<','>','<','<','<','>','<','<','>','<','<','>','>','>','>','<','<','>','<','>','>','>','>','<','<','<','>','>','>','<','<','<','<','>','>','>','>','<','<','>','>','>','>','<','<','>','>','>','<','>','>','>','>','<','<','<','>','>','<','<','<','>','>','>','>','<','<','>','<','<','>','<','<','<','>','>','<','>','>','<','<','>','>','>','<','<','>','>','<','<','>','>','<','>','>','>','<','<','<','>','<','>','<','<','<','<','>','>','<','>','>','<','>','>','<','>','>','>','<','<','<','>','>','>','<','<','<','>','<','<','<','>','>','<','<','>','>','>','>','<','>','<','<','>','>','>','>','<','<','>','>','>','>','<','>','<','<','<','>','<','<','>','>','<','<','<','>','<','>','>','>','<','>','>','>','<','>','<','<','>','>','<','>','>','>','<','>','<','<','>','>','<','<','<','<','>','>','<','<','>','>','>','>','<','>','>','>','<','<','<','>','<','>','>','>','>','<','>','>','>','>','<','>','>','<','>','>','>','>','<','<','<','<','>','>','>','<','<','<','>','>','>','<','<','>','<','<','>','>','>','>','<','<','<','<','>','<','<','>','>','>','<','<','<','>','>','>','<','<','<','<','>','>','>','>','<','>','>','>','<','<','<','>','>','>','>','<','<','<','<','>','<','>','>','>','<','<','>','>','<','<','<','>','>','>','<','<','<','<','>','<','>','>','<','<','<','>','<','<','>','>','>','>','<','<','<','>','>','<','>','<','<','<','<','>','>','<','>','<','<','>','>','>','<','>','>','>','>','<','<','>','>','>','<','<','<','>','<','<','<','<','>','>','>','>','<','<','<','>','>','>','<','<','<','<','>','<','<','<','<','>','>','>','<','>','>','>','>','<','<','<','<','>','>','<','<','>','>','>','<','>','>','<','<','>','>','<','<','>','>','>','>','<','<','<','<','>','>','>','<','<','>','<','<','>','>','>','>','<','<','<','>','>','<','<','<','<','>','>','<','<','<','>','>','<','>','>','>','<','<','<','>','>','>','<','<','>','<','<','<','<','>','<','<','>','>','>','<','>','>','<','<','<','>','>','<','<','<','>','>','>','>','<','<','<','>','>','<','>','<','<','>','>','>','<','<','>','>','>','<','<','<','<','>','<','<','>','>','>','<','<','<','>','>','<','<','>','<','<','<','>','>','>','<','<','<','>','>','>','<','>','<','<','<','<','>','>','<','<','>','>','>','>','<','>','>','>','<','<','>','<','<','<','>','>','>','>','<','<','>','<','<','>','>','>','>','<','<','<','<','>','>','<','>','<','<','<','>','>','>','>','<','<','>','>','<','>','>','>','<','<','<','<','>','<','>','>','<','<','<','>','<','<','>','>','>','<','<','<','>','<','<','<','>','>','>','<','>','>','>','>','<','<','<','>','>','<','>','>','>','>','<','<','<','>','>','>','<','<','>','>','>','>','<','<','<','<','>','>','<','>','>','>','<','<','<','<','>','<','<','<','<','>','>','>','>','<','<','<','>','>','>','>','<','>','<','<','<','<','>','>','>','>','<','<','<','>','>','>','<','<','>','<','<','<','<','>','>','<','>','<','<','>','>','>','<','<','<','>','>','>','>','<','<','>','<','<','<','>','>','<','<','>','>','>','<','<','<','>','>','>','>','<','<','<','>','<','<','<','>','>','>','<','<','<','>','<','>','>','>','<','<','>','<','>','<','<','<','>','>','>','<','<','<','<','>','>','<','<','>','>','>','<','<','<','>','<','<','<','>','<','<','>','<','<','<','<','>','<','<','<','>','<','<','>','>','>','>','<','>','>','<','<','<','>','<','<','<','<','>','>','<','>','>','<','>','>','<','>','>','>','>','<','<','<','<','>','>','<','<','<','<','>','>','>','<','>','>','>','<','>','>','<','>','<','>','>','<','<','<','<','>','>','<','>','<','<','<','>','<','<','>','<','>','>','>','>','<','<','>','>','>','<','<','<','<','>','>','>','<','<','>','>','<','<','<','>','>','>','<','<','<','<','>','<','<','<','>','>','>','>','<','<','<','<','>','>','>','>','<','>','>','>','>','<','<','>','<','<','<','<','>','<','<','<','>','>','>','>','<','<','<','>','<','<','<','>','<','<','<','<','>','>','>','>','<','<','<','<','>','>','>','<','<','<','>','>','<','>','<','>','>','>','<','>','<','<','<','<','>','>','>','>','<','<','<','>','>','>','>','<','>','>','<','>','>','<','>','>','>','<','<','<','<','>','>','>','<','<','<','>','>','>','<','>','<','<','<','>','>','>','>','<','<','>','>','>','<','>','>','<','<','<','>','>','>','<','<','<','<','>','>','<','<','<','<','>','>','>','>','<','<','<','>','>','>','<','<','<','>','>','>','>','<','<','>','<','<','>','>','<','>','>','>','>','<','<','<','<','>','>','>','<','>','>','<','<','<','<','>','>','<','<','<','>','>','>','<','<','<','>','<','>','>','<','<','>','<','<','<','>','>','<','<','<','>','>','>','>','<','<','<','<','>','>','>','<','<','>','>','>','>','<','<','<','<','>','<','>','>','>','<','>','>','>','>','<','<','<','<','>','>','>','<','<','<','>','>','>','<','>','>','>','>','<','<','<','<','>','>','<','<','<','>','>','>','>','<','<','>','<','>','>','<','<','<','<','>','>','>','<','<','<','>','<','<','>','<','<','>','>','<','<','>','<','>','<','<','<','<','>','>','>','<','<','>','<','<','<','>','>','<','>','>','>','<','<','>','>','>','<','<','>','<','<','<','>','>','>','<','<','<','<','>','>','>','<','<','<','<','>','>','<','<','>','>','<','<','<','<','>','>','>','<','<','<','<','>','>','<','<','<','>','>','<','<','<','>','<','<','<','>','<','<','<','<','>','>','<','>','>','<','<','<','<','>','>','>','>','<','>','>','>','<','<','<','>','>','>','<','<','<','<','>','>','<','<','<','>','>','>','>','<','<','>','>','>','>','<','<','<','<','>','>','>','>','<','<','<','>','>','>','<','<','>','<','<','<','>','<','>','>','>','>','<','<','>','<','<','<','>','>','>','<','<','>','<','>','>','<','<','>','<','>','<','<','<','<','>','>','>','>','<','<','<','<','>','>','<','<','<','>','>','>','<','<','<','<','>','<','>','>','>','>','<','<','<','<','>','>','<','<','<','<','>','>','<','<','>','>','<','<','<','>','>','<','<','>','>','>','>','<','<','<','<','>','>','>','>','<','>','>','>','<','<','>','>','>','>','<','<','<','>','>','>','>','<','<','>','>','>','>','<','<','>','<','<','>','>','>','>','<','<','>','>','<','<','<','<','>','>','<','>','>','>','>','<','>','<','<','>','>','>','<','>','>','<','<','<','>','>','>','>','<','<','<','<','>','>','>','<','<','<','<','>','>','>','>','<','<','<','>','<','<','<','>','>','>','>','<','<','<','<','>','>','>','<','<','<','<','>','>','<','<','<','<','>','>','>','<','<','<','>','<','<','<','<','>','>','<','<','<','<','>','<','>','>','>','>','<','<','<','>','>','>','>','<','<','>','>','>','>','<','<','<','<','>','>','>','<','<','>','<','<','<','<','>','<','<','<','>','<','<','<','<','>','>','>','>','<','>','>','>','<','>','>','>','<','<','<','<','>','>','>','>','<','<','>','<','<','<','<','>','>','>','<','>','>','>','<','<','<','>','>','>','>','<','>','>','>','>','<','>','>','<','<','>','>','>','>','<','>','<','<','<','>','>','>','<','<','<','<','>','>','<','<','>','>','>','<','<','>','>','>','<','<','<','<','>','>','>','<','>','>','>','<','<','<','<','>','<','<','>','>','>','<','>','>','>','<','>','>','<','<','>','<','<','<','>','>','>','>','<','<','<','>','>','>','>','<','<','<','>','>','<','>','>','<','<','<','>','<','<','<','>','>','>','<','<','<','<','>','>','>','<','<','<','>','>','>','<','>','>','>','<','<','<','>','<','<','<','<','>','>','>','>','<','<','<','<','>','<','<','>','>','>','>','<','<','<','>','>','<','<','<','<','>','>','<','<','<','>','>','>','>','<','<','>','>','>','<','<','>','>','>','>','<','<','>','>','>','<','<','<','>','<','<','>','>','>','<','>','<','>','<','>','<','>','>','>','>','<','>','>','>','>','<','<','>','<','>','<','<','>','>','<','<','>','>','>','<','<','<','<','>','>','>','>','<','<','<','<','>','<','>','>','<','<','<','<','>','<','<','<','>','>','>','<','<','>','>','>','>','<','<','>','<','<','<','<','>','>','>','<','>','>','<','<','>','<','>','>','<','>','>','>','>','<','>','>','<','<','<','<','>','>','>','>','<','<','<','<','>','>','>','<','>','>','>','>','<','<','<','<','>','>','<','<','<','<','>','>','<','>','<','>','>','<','<','>','<','>','>','>','<','<','<','>','>','>','>','<','>','<','>','>','>','>','<','>','<','<','<','>','>','<','<','<','<','>','>','>','<','<','<','<','>','>','<','<','<','>','>','>','>','<','<','<','>','>','>','<','<','<','>','<','<','>','>','<','<','<','>','>','<','<','<','<','>','>','>','<','<','>','>','>','<','<','>','>','<','>','>','>','<','>','>','<','<','<','>','>','>','>','<','<','<','>','<','<','<','<','>','>','<','>','<','<','<','<','>','>','>','>','<','<','<','<','>','>','>','<','<','<','<','>','>','<','>','>','<','<','<','>','>','>','<','<','<','>','>','<','<','<','>','>','>','<','<','<','<','>','>','>','<','<','>','>','<','<','<','>','<','<','<','<','>','>','>','>','<','<','<','>','>','>','>','<','<','>','<','<','<','<','>','>','<','<','<','>','<','<','<','<','>','>','>','<','<','<','<','>','<','<','>','>','>','>','<','<','<','>','<','<','<','<','>','>','<','<','<','>','>','>','<','>','>','>','<','>','<','<','<','>','>','>','<','<','>','>','>','<','<','>','>','<','<','<','<','>','>','>','<','>','>','<','<','<','<','>','>','>','<','<','<','>','>','>','<','>','<','<','<','<','>','>','>','>','<','<','<','>','>','>','<','<','>','>','>','<','<','>','>','>','<','>','>','<','>','>','>','<','<','<','>','<','>','>','>','<','<','<','<','>','>','>','<','<','<','>','>','>','<','>','>','>','<','<','<','>','>','<','<','<','>','>','<','>','<','<','<','<','>','>','>','<','>','>','>','<','<','>','>','<','<','>','>','<','>','>','>','<','<','>','>','>','>','<','>','>','<','>','>','>','>','<','<','<','>','>','<','<','>','>','>','>','<','<','<','<','>','>','<','<','<','>','>','<','<','>','>','<','<','>','>','>','>','<','<','<','>','>','<','<','>','>','<','<','<','>','<','<','<','>','>','>','<','>','>','<','<','<','>','>','>','>','<','<','>','>','<','>','>','>','>','<','<','>','<','<','<','>','>','>','>','<','<','>','>','>','>','<','<','>','>','<','<','>','>','>','<','<','<','>','>','>','<','>','>','>','>','<','<','<','>','<','>','>','>','>','<','<','<','>','>','<','<','<','<','>','>','>','>','<','<','<','<','>','<','<','>','>','<','<','<','>','>','<','<','<','>','>','>','>','<','<','>','>','>','>','<','<','<','<','>','<','<','<','<','>','>','>','<','<','<','>','>','>','<','>','>','<','<','<','>','>','>','<','<','<','>','<','>','>','>','>','<','<','<','<','>','>','<','<','<','>','>','<','>','>','>','<','<','>','>','>','>','<','<','<','>','>','>','<','<','<','<','>','>','>','>','<','<','>','<','<','>','>','>','<','<','>','>','>','<','>','>','<','>','<','<','<','>','<','>','>','>','<','<','<','<','>','>','>','>','<','<','<','<','>','>','<','<','<','>','>','>','>','<','<','<','>','>','<','<','>','>','>','<','<','<','>','>','<','<','>','>','<','<','<','<','>','>','<','<','<','>','>','<','<','<','<','>','>','<','<','>','>','>','>','<','>','>','>','<','<','<','<','>','>','>','<','<','<','<','>','>','>','<','>','<','>','<','<','<','<','>','<','<','<','>','>','>','<','<','<','<','>','<','<','<','>','>','>','>','<','<','<','<','>','>','>','>','<','>','>','>','<','>','>','>','<','>','>','>','<','<','>','>','>','>','<','<','<','<','>','>','>','<','<','<','<','>','>','>','<','<','<','>','>','>','>','<','<','<','<','>','>','>','>','<','<','<','<','>','<','>','<','<','<','<','>','>','>','>','<','<','<','>','>','>','>','<','>','<','<','>','>','>','<','<','<','>','>','>','>','<','<','>','>','<','<','<','<','>','>','>','>','<','<','<','>','<','<','<','<','>','>','>','<','<','<','>','>','<','<','>','>','>','<','<','<','>','>','>','<','<','>','>','>','>','<','<','>','>','<','>','>','<','<','>','<','<','<','>','>','>','>','<','<','>','>','>','>','<','<','>','>','<','>','<','<','>','>','<','<','<','<','>','>','<','>','>','>','<','<','<','>','>','>','>','<','<','<','<','>','<','>','<','<','>','>','>','>','<','<','>','>','>','>','<','<','<','>','<','>','<','<','<','<','>','>','<','<','<','<','>','>','>','>','<','<','>','>','>','>','<','<','>','>','>','>','<','>','>','>','<','<','<','>','<','<','<','<','>','>','>','<','<','<','>','>','>','<','<','<','>','>','<','<','<','<','>','>','<','<','<','<','>','>','<','<','<','<','>','>','<','<','<','>','>','>','<','>','<','<','<','>','>','>','<','<','>','>','>','>','<','<','<','>','>','>','>','<','<','<','>','>','>','>','<','>','<','<','<','<','>','>','>','>','<','<','<','<','>','>','>','>','<','>','>','<','<','<','>','<','<','<','<','>','>','>','>','<','<','<','<','>','<','>','>','>','<','>','>','>','>','<','>','<','>','>','>','<','>','<','<','<','<','>','>','>','<','<','<','<','>','>','>','>','<','<','>','<','<','<','<','>','>','>','>','<','>','>','>','<','>','>','>','>','<','>','>','<','<','>','<','<','<','<','>','<','<','>','>','>','>','<','>','>','<','<','<','<','>','<','>','>','>','<','<','<','>','>','<','<','>','>','>','>','<','<','>','>','>','>','<','<','>','>','>','>','<','<','<','<','>','>','>','>','<','>','>','>','>','<','<','<','>','>','>','>','<','>','<','>','>','<','<','<','>','>','>','>','<','<','<','>','>','<','<','<','<','>','>','>','>','<','<','>','>','>','<','<','<','>','>','>','<','<','<','>','>','<','<','<','<','>','>','<','<','<','<','>','>','>','>','<','<','<','<','>','>','<','>','<','<','<','<','>','>','<','<','<','<','>','<','<','<','>','>','>','>','<','<','<','<','>','>','<','<','>','>','>','>','<','>','>','<','<','<','>','>','>','<','<','<','>','<','>','>','>','<','<','<','>','<','>','>','<','>','>','>','>','<','<','<','<','>','>','>','>','<','<','<','>','>','<','<','>','>','<','>','>','>','>','<','<','>','>','>','>','<','<','<','<','>','>','>','>','<','<','<','<','>','>','<','>','>','<','<','<','<','>','>','<','>','>','<','<','<','<','>','>','>','>','<','<','>','>','>','<','<','>','>','>','>','<','<','<','<','>','>','>','<','<','>','<','<','<','>','>','>','>','<','<','<','>','>','>','>','<','<','>','>','>','>','<','<','>','>','<','>','>','>','<','<','<','<','>','<','<','<','>','>','>','>','<','<','<','<','>','>','<','<','<','<','>','>','>','<','<','>','>','>','>','<','<','<','>','<','<','<','<','>','<','<','>','>','<','<','<','<','>','>','<','<','<','<','>','<','<','>','>','<','>','>','>','>','<','<','<','>','>','<','>','>','>','>','<','<','<','>','>','>','>','<','<','>','>','<','<','>','>','>','>','<','<','<','<','>','<','>','<','<','>','<','<','>','<','<','>','>','<','<','<','<','>','>','>','>','<','>','>','>','<','<','<','>','<','<','>','<','>','>','<','<','<','>','>','>','<','<','<','>','<','>','>','<','<','>','>','>','<','<','<','>','>','>','<','<','>','>','>','<','<','>','>','>','<','<','<','>','>','>','<','<','<','<','>','<','>','>','<','<','<','>','>','<','<','>','<','>','>','>','<','<','<','>','>','>','<','<','<','<','>','>','>','<','<','>','<','>','>','>','>','<','<','<','<','>','>','<','<','>','>','<','<','<','>','>','<','<','<','>','<','<','>','>','>','<','<','>','>','<','>','>','<','>','>','<','<','<','>','>','>','<','>','>','<','<','>','>','>','>','<','<','<','<','>','>','>','>','<','<','<','<','>','>','<','<','<','>','>','>','<','<','>','>','>','>','<','<','<','<','>','>','>','>','<','<','>','>','<','>','<','<','<','<','>','>','<','<','>','>','<','<','>','>','>','<','>','>','<','>','>','>','>','<','<','>','>','>','<','<','>','>','>','>','<','<','<','>','>','>','<','<','<','<','>','>','>','<','<','>','>','>','>','<','<','<','<','>','>','>','>','<','<','>','>','>','<','<','<','>','>','<','<','<','>','>','<','<','>','>','>','<','<','>','>','>','<','<','<','>','>','>','>','<','<','<','<','>','<','<','>','>','<','<','>','<','<','<','>','<','>','>','>','>','<','<','<','>','<','<','<','<','>','>','>','>','<','<','<','<','>','<','>','>','>','>','<','>','<','<','>','<','<','>','>','>','<','<','<','>','<','>','>','>','>','<','<','<','>','>','<','<','<','<','>','>','<','<','<','>','>','>','<','<','>','<','<','>','>','>','<','<','<','<','>','>','<','<','>','>','>','<','<','>','>','<','<','<','>','<','<','<','>','>','<','>','>','>','<','<','>','>','<','<','<','<','>','<','>','<','<','<','<','>','>','>','<','<','<','>','>','>','>','<','<','<','>','<','<','>','>','>','>','<','>','>','<','<','<','<','>','>','>','>','<','<','<','<','>','<','<','>','>','>','>','<','<','<','>','>','<','<','<','<','>','>','>','<','<','>','<','>','>','>','>','<','>','<','<','>','<','>','>','>','<','>','>','>','>','<','>','<','<','>','<','<','>','>','<','<','<','<','>','>','<','<','<','<','>','>','<','>','>','<','<','<','>','>','<','<','>','<','<','>','>','<','<','<','>','>','<','>','>','<','<','<','>','>','>','>','<','<','<','>','>','<','<','<','<','>','>','<','>','>','>','>','<','<','<','>','<','>','>','>','<','>','>','>','<','<','<','<','>','<','<','>','>','>','<','>','<','<','<','<','>','>','>','>','<','<','<','>','>','<','>','>','>','>','<','<','>','>','<','<','<','<','>','<','<','<','<','>','>','>','<','>','<','<','>','>','<','<','<','>','<','>','>','>','>','<','<','>','>','>','>','<','<','>','>','<','<','<','<','>','<','>','>','<','<','<','<','>','<','<','<','<','>','>','>','<','<','>','>','>','<','<','>','>','<','<','<','>','>','>','<','<','<','<','>','>','>','>','<','<','<','<','>','<','<','>','<','>','>','<','<','<','<','>','>','>','<','<','>','<','>','>','>','<','>','<','<','<','>','<','<','>','>','>','>','<','<','<','>','<','<','<','>','<','<','<','<','>','<','<','<','>','>','>','>','<','<','<','>','<','>','>','>','>','<','>','>','>','<','>','>','>','>','<','<','>','>','<','<','>','>','>','>','<','<','<','<','>','>','<','<','<','>','>','>','<','<','<','<','>','>','>','>','<','<','<','>','>','<','>','<','<','<','>','>','>','>','<','>','<','<','>','>','>','>','<','<','<','>','<','>','>','>','>','<','>','>','>','>','<','<','<','<','>','>','>','>','<','>','>','>','>','<','<','>','<','>','>','<','<','<','>','>','>','<','<','<','<','>','<','>','>','>','<','>','>','>','>','<','<','>','<','<','<','<','>','<','>','>','>','<','<','>','>','>','<','<','>','>','>','<','<','>','<','<','<','<','>','>','>','<','<','<','>','>','<','<','<','<','>','>','<','>','>','>','<','<','<','>','>','>','>','<','>','>','<','<','>','>','>','<','<','<','<','>','<','<','<','>','>','>','<','>','>','<','<','<','>','<','>','>','<','<','<','<','>','>','<','>','<','>','>','>','<','<','<','>','>','>','<','<','>','>','<','<','<','<','>','>','<','<','>','>','>','>','<','<','<','<','>','<','<','<','>','>','<','<','>','<','<','<','<','>','>','>','>','<','<','>','>','>','>','<','>','>','>','>','<','>','>','<','<','<','<','>','>','<','<','<','>','<','>','>','>','<','<','<','>','<','<','<','<','>','<','<','>','>','<','>','<','<','<','<','>','>','<','<','<','>','<','<','>','>','>','<','<','>','<','<','<','>','<','<','<','>','<','<','<','>','>','<','<','<','>','>','>','<','>','>','>','<','<','<','<','>','>','<','<','>','>','>','<','<','<','>','>','<','>','>','>','>','<','<','<','>','>','<','>','>','>','>','<','<','<','>','>','>','<','>','>','>','<','<','<','>','>','>','>','<','<','<','<','>','<','<','<','<','>','>','>','>','<','<','>','>','<','<','<','<','>','>','>','<','<','<','<','>','>','>','>','<','>','>','>','<','>','>','>','<','<','<','>','>','>','<','<','<','>','<','<','>','>','>','<','>','<','<','<','>','>','<','<','>','<','>','<','>','>','<','>','>','<','<','>','<','<','<','<','>','<','<','<','>','>','>','>','<','<','<','>','>','>','>','<','<','>','>','>','>','<','<','<','<','>','>','>','>','<','>','>','>','>','<','<','<','>','>','>','<','>','>','>','>','<','<','<','>','<','<','<','<','>','>','>','>','<','<','<','<','>','<','<','<','<','>','<','>','>','>','>','<','<','>','<','>','>','>','<','>','<','<','<','<','>','>','>','>','<','>','>','<','<','<','>','>','>','>','<','<','>','>','>','<','<','<','>','>','<','>','>','>','>','<','<','>','>','>','<','<','>','>','<','>','>','<','<','<','>','>','>','<','<','<','<','>','<','<','>','>','>','>','<','<','>','>','>','>','<','<','<','>','>','<','>','>','<','<','>','>','>','>','<','<','<','<','>','<','<','<','>','>','>','>','<','<','>','<','<','<','<','>','>','>','>','<','>','>','<','<','<','<','>','<','>','>','>','>','<','<','>','>','>','<','<','<','>','>','>','<','>','<','>','>','>','>','<','<','>','>','>','>','<','<','<','>','>','>','<','<','>','>','<','<','>','>','>','<','>','>','>','<','<','<','>','<','>','>','<','>','>','>','<','<','<','<','>','<','>','>','>','>','<','<','<','<','>','<','<','<','<','>','>','<','<','>','>','>','>','<','<','>','>','>','<','<','<','<','>','<','<','<','<','>','>','<','<','<','>','>','>','>','<','<','>','>','>','<','<','>','<','<','<','<','>','>','>','>','<','<','<','<','>','>','<','<','<','>','>','>','>','<','>','>','<','<','<','>','<','<','<','>','<','<','>','>','<','<','<','<','>','>','>','<','<','<','>','>','>','<','<','<','<','>','>','>','>','<','>','>','<','<','>','>','<','>','<','<','<','>','>','>','<','<','>','>','>','<','<','<','>','<','<','>','<','<','<','>','>','>','<','<','<','>','>','>','<','<','<','>','>','>','>','<','<','<','>','>','>','<','<','<','<','>','>','<','<','>','>','<','<','<','>','<','<','<','>','>','>','>','<','<','>','>','>','>','<','>','>','>','>','<','<','<','<','>','>','>','<','<','>','>','<','<','<','>','>','>','<','<','>','>','>','>','<','<','<','<','>','>','>','<','<','<','>','<','<','>','<','<','<','<','>','>','<','<','<','>','>','<','<','<','>','>','>','>','<','<','>','>','>','>','<','>','>','>','>','<','<','>','>','<','>','>','>','>','<','<','<','<','>','<','<','>','>','<','<','<','<','>','<','<','<','<','>','>','<','>','>','>','<','<','<','>','>','<','<','<','>','>','<','<','<','<','>','<','<','<','<','>','>','>','<','<','<','>','>','<','<','<','>','>','>','>','<','>','>','>','>','<','<','<','<','>','>','>','<','>','<','<','<','<','>','<','<','>','<','<','<','>','>','>','<','<','<','<','>','>','<','<','>','>','>','<','<','<','>','>','>','<','<','<','>','>','>','<','<','<','<','>','>','<','<','>','>','>','<','<','<','<','>','>','>','>','<','<','>','>','<','<','<','>','>','>','<','<','>','<','>','>','<','<','<','<','>','>','>','>','<','<','>','>','>','<','>','>','>','<','>','>','>','>','<','<','<','>','>','>','<','<','>','>','<','>','>','>','>','<','<','<','>','>','>','<','>','>','>','<','<','<','>','>','>','>','<','<','<','>','>','>','>','<','>','>','>','>','<','>','>','>','<','<','<','<','>','>','>','<','<','<','>','>','>','<','<','>','>','<','>','>','>','<','<','<','>','>','<','<','<','<','>','<','<','<','>','>','>','<','<','>','>','>','>','<','>','<','<','<','<','>','<','>','>','<','<','>','>','>','<','<','<','<','>','>','<','>','>','>','<','<','>','>','>','<','>','<','<','<','<','>','>','>','<','<','<','<','>','>','<','>','<','<','>','<','>','>','<','<','<','<','>','>','>','<','>','>','<','<','>','>','<','<','<','<','>','<','<','>','>','>','>','<','<','>','>','<','>','<','>','>','<','<','<','<','>','>','<','<','<','<','>','>','>','>','<','<','<','>','>','>','>','<','<','>','>','<','<','<','>','<','>','>','>','>','<','<','>','<','<','>','<','>','>','>','<','>','<','>','>','>','>','<','<','<','>','<','<','>','>','>','>','<','<','<','<','>','>','<','<','<','<','>','<','<','<','<','>','<','<','<','>','>','<','<','>','>','<','<','<','<','>','>','>','<','<','>','>','>','>','<','<','<','>','<','>','>','>','<','>','>','>','>','<','>','>','>','>','<','<','<','>','>','>','>','<','<','>','>','>','>','<','>','>','>','>','<','<','>','<','<','>','>','>','>','<','<','<','<','>','>','>','>','<','<','<','>','>','<','<','>','>','>','<','<','<','<','>','>','>','>','<','<','<','<','>','>','>','<','>','>','>','<','>','>','>','<','<','<','>','>','>','>','<','<','>','>','>','>','<','>','>','<','>','<','<','<','>','>','>','<','<','<','>','>','>','>','<','>','>','>','>','<','<','<','<','>','>','>','<','<','<','>','<','<','<','>','>','>','<','<','>','>','>','>','<','>','<','>','>','>','<','<','<','<','>','<','<','>','>','<','>','>','>','>','<','<','>','>','<','>','>','>','>','<','<','<','<','>','>','>','>','<','<','<','<','>','>','>','<','<','>','>','<','<','<','>','<','<','<','<','>','>','>','<','<','>','>','>','<','>','>','>','<','<','<','>','>','<','>','>','>','<','>','<','<','<','>','>','<','<','>','<','<','<','<','>','>','>','>','<','<','>','>','>','<','<','<','>','>','>','<','<','<','<','>','>','<','<','<','<','>','>','>','>','<','<','<','<','>','<','<','>','>','<','<','<','>','<','<','<','>','>','>','<','<','<','>','>','<','<','<','<','>','>','>','<','>','>','<','<','>','>','>','>','<','>','>','<','<','<','>','<','<','>','>','<','<','<','<','>','>','<','<','<','>','>','<','<','>','>','>','<','>','>','>','<','<','<','>','>','>','>','<','>','>','>','>','<','<','<','<','>','>','<','>','>','>','<','>','<','>','>','>','<','<','<','>','>','<','<','<','<','>','>','>','<','<','<','<','>','>','<','<','<','>','>','>','<','<','>','>','>','>','<','>','>','<','<','<','<','>','>','<','>','>','>','>','<','<','>','<','<','<','>','<','<','>','>','>','<','<','<','>','>','>','>','<','<','<','>','>','<','<','>','>','>','<','>','>','<','>','>','<','<','<','>','<','<','<','<','>','>','>','<','<','<','<','>','>','<','<','<','<','>','>','>','<','<','>','>','>','>','<','<','<','<','>','<','<','<','>','>','>','<','<','<','<','>','>','<','<','<','>','>','>','>','<','<','<','>','>','>','>','<','>','>','>','<','<','>','<','<','<','>','<','>','>','>','<','>','>','>','<','<','<','>','>','>','<','<','<','>','>','>','<','<','<','<','>','<','<','<','<','>','>','<','<','<','>','>','>','>','<','<','<','>','>','<','<','<','>','>','>','>','<','>','<','>','>','>','>','<','<','<','>','>','>','>','<','<','<','>','>','>','>','<','>','>','<','<'];

// const input = ['>','>','>','<','<','>','<','>','>','<','<','<','>','>','<','>','>','>','<','<','<','>','>','>','<','<','<','>','<','<','<','>','>','<','>','>','<','<','>','>'];

const shapes = {
    '-': [['#','#','#','#']],
    '+': [
        ['.','#','.'],
        ['#','#','#'],
        ['.','#','.'],
    ],
    'L': [
        ['.','.','#'],
        ['.','.','#'],
        ['#','#','#'],
    ],
    'I': [
        ['#'],
        ['#'],
        ['#'],
        ['#'],
    ],
    'O': [
        ['#','#'],
        ['#','#'],
    ],
};

const order = ['-','+','L','I','O'];

let chamber = [
    ['.','.','.','.','.','.','.'],
    ['.','.','.','.','.','.','.'],
    ['.','.','.','.','.','.','.'],
    ['.','.','.','.','.','.','.'],
    ['.','.','.','.','.','.','.'],
    ['.','.','.','.','.','.','.'],
    ['.','.','.','.','.','.','.'],
];

let height = 0;
let splicedOut = 0;
let curRock = 0;
let curWind = 0;
let seen = {};
let cyclePeriod = null;
let cycleOffset = null;
let cycleHeight = null;
let cycleGrowth = null;

const storeShape = (shape, left, bottom) => {
    let row = bottom;
    for (let i = shape.length - 1; i >= 0; i--){
        for (let j = 0; j < shape[i].length; j++){
            if (shape[i][j] === '#') chamber[chamber.length - row - 1][left + j] = shape[i][j];
        }
        row++;
    }
};

const drawChamber = () => {
    const lines = [];
    for (const c of chamber){
        lines.push(c.join(''));
    }
    for (const line of lines) console.log(line);
}

const checkCollision = (isLeft = true, shape, left, bottom) => {
    if (isLeft){
        if (left === 0) return left;
        let row = bottom;
        for (let i = shape.length - 1; i >= 0; i--){
            for (let j = 0; j < shape[i].length; j++){
                const current = shape[i][j];
                const next = chamber[chamber.length - row - 1][left + j - 1];
                if (current === '#' && next === '#') return left;
            }
            row++;
        }
        return left - 1;
    } else {
        if (left + shape[0].length >= chamber[0].length) return left;
        let row = bottom;
        for (let i = shape.length - 1; i >= 0; i--){
            for (let j = 0; j < shape[i].length; j++){
                const current = shape[i][j];
                const next = chamber[chamber.length - row - 1][left + j + 1];
                if (current === '#' && next === '#') return left;
            }
            row++;
        }
        return left + 1;
    }
};

const makeHash = () => {
    // wind index
    // shape index
    // height map (0-6, deltas between each)
    const hashes = [null,null,null,null,null,null,null];
    let firstHeight = null;
    for (let i=0;i<chamber.length;i++){
        for (let j=0;j<chamber[i].length;j++){
            if (firstHeight === null && chamber[i][j] === '#') firstHeight = i;
            if (chamber[i][j] === '#' && hashes[j] === null) hashes[j] =  firstHeight - i;
        }
        if (!hashes.includes(null)) break;
    }
    return `${curWind},${curRock},${hashes.join(',')}`;
};

const simulateRock = (pass) => {
    let canMove = true;
    const shape = shapes[order[curRock]];
    const shapeWidth = shape[0].length;
    const shapeHeight = shape.length;

    // find cycle details
    if (!cycleOffset){
        const hash = makeHash();
        if (seen[hash]){
            cycleOffset = seen[hash].index; // what is the starting pass number of our cycle?
            cyclePeriod = pass - seen[hash].index; // how long is one period of our cycle?
            cycleHeight = seen[hash].height; // what was the height when our cycle started?
            cycleGrowth = height - seen[hash].height; // how much does height grow per cycle???
        } else {
            seen[hash] = {
                index: pass,
                height,
            };
        }
    }

    let bottom = height + 4;
    let left = 2;
    // add empty rows to fit our shapes
    if (bottom + 5 > chamber.length){
        for (let i=0;i<(bottom + 5) - chamber.length;i++) chamber.unshift(['.','.','.','.','.','.','.']);
    }

    while (canMove){
        bottom--;
        // apply wind
        if (input[curWind] === '<'){
            // left
            left = checkCollision(true, shape, left, bottom);
        } else {
            // right
            left = checkCollision(false, shape, left, bottom);
        }
        // are we at the bottom?
        if (bottom === 0){
            canMove = false;
            storeShape(shape, left, bottom);
        } else {
            // check down of each row
            for (let i=0;i<shapeWidth;i++){
                if (shape[shape.length-1][i] === '#' && chamber[chamber.length - bottom][left + i] === '#'){
                    canMove = false;
                    storeShape(shape, left, bottom);
                    break;
                } else if (shape.length > 1 && shape[shape.length-2][i] === '#' && chamber[chamber.length - bottom - 1][left + i] === '#'){
                    canMove = false;
                    storeShape(shape, left, bottom);
                    break;
                } else if (bottom === 0){
                    canMove = false;
                    storeShape(shape, left, bottom);
                    break;
                }
            }
        }
        curWind = (curWind + 1) % input.length;
    }
    height = Math.max(height, bottom + shapeHeight);
    curRock = (curRock + 1) % order.length;
};

for (let i=0;i<10000;i++){
    simulateRock(i);
    if (cyclePeriod) break;
}

// honestly i have no idea...a lot of trial and error with smaller pass goals
const goal = 1000000000000;
// how many full periods can we get in our goal, after accounting for the cycle start offset
const periods = Math.floor((goal - cycleOffset)/cyclePeriod); 
// how many extra passes do we have after full cycles?
const remainder = (goal-cycleOffset)%cyclePeriod;
// find where (in a cycle) our passes should actually end
const next = Object.values(seen).find(v => v.index === cycleOffset+remainder);
// set height for full cycles
let result = cycleHeight + (cycleGrowth*periods);
// add height differential for remainder passes (this doesn't always work, a lot of off-by-one for some reason)
result += next.height - cycleHeight;
console.log(result);
