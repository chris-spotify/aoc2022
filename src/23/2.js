const input = [['#','.','.','.','#','.','#','#','#','#','.','.','.','.','.','.','.','#','#','#','.','#','.','.','#','#','.','#','#','#','#','#','.','#','.','.','.','#','#','.','#','#','.','#','#','.','#','.','#','.','#','.','.','.','#','.','#','.','.','.','#','#','.','.','.','#','.','.','#','.'],['#','.','#','.','#','#','#','#','.','#','.','#','.','#','#','#','.','.','.','#','#','#','#','#','.','#','#','.','.','#','#','#','#','.','.','#','.','#','#','#','.','.','.','#','.','#','.','.','.','.','.','.','.','.','.','.','.','#','.','.','#','.','#','.','.','#','#','.','.','.'],['#','.','#','#','#','#','#','.','.','.','.','#','.','.','#','#','#','.','#','.','#','#','#','.','.','#','#','.','#','.','#','.','#','.','.','#','.','.','.','#','#','#','.','.','.','#','#','#','#','.','#','.','#','#','.','#','.','#','.','.','#','.','#','#','#','.','#','.','.','#'],['.','#','.','.','#','#','.','.','.','.','.','#','#','.','#','#','.','#','.','#','.','.','.','#','#','.','#','.','#','#','.','.','#','.','.','#','#','.','#','.','#','.','.','.','#','#','#','#','#','.','.','.','#','#','#','#','.','.','#','#','#','.','.','.','#','#','.','.','#','.'],['#','#','.','.','.','#','#','#','.','.','#','#','.','.','.','.','#','#','.','#','.','#','.','.','.','#','.','.','.','#','.','.','.','#','#','.','.','.','#','.','.','#','.','#','.','.','#','#','.','.','#','#','#','.','.','#','#','.','.','.','.','.','.','#','#','#','#','.','#','.'],['#','.','.','#','#','.','#','.','#','.','.','.','#','#','#','#','.','.','.','.','.','#','#','#','.','#','.','.','.','#','#','#','#','#','.','.','.','.','.','#','#','.','#','#','.','#','.','.','.','.','#','.','#','.','.','.','.','.','.','.','#','#','#','#','.','.','#','.','#','.'],['.','.','#','.','#','#','#','.','.','.','.','#','#','#','.','.','#','#','.','.','.','.','.','#','.','.','.','#','.','.','.','#','#','#','#','#','.','.','.','.','#','.','#','#','#','.','.','.','.','.','#','#','#','.','.','#','#','#','.','#','#','#','#','#','.','.','#','.','.','.'],['#','.','.','#','#','#','.','.','#','#','.','.','.','#','#','.','#','.','#','.','.','.','#','#','.','#','.','#','.','#','.','#','#','#','.','#','#','#','#','#','#','#','.','#','.','#','#','#','.','.','.','#','.','.','#','.','#','#','#','#','#','#','.','.','.','.','#','#','.','#'],['#','.','.','.','.','.','#','#','#','.','.','.','.','.','#','#','#','#','.','#','.','.','#','.','.','.','#','#','.','.','#','.','#','.','#','.','.','.','#','#','.','.','.','.','#','#','.','#','#','#','.','#','.','#','.','.','.','#','.','#','.','#','.','.','#','.','#','#','#','.'],['.','#','.','.','.','#','.','.','.','.','.','.','#','.','.','.','.','.','.','#','#','.','.','#','#','.','#','.','.','.','.','#','.','.','.','.','.','.','.','#','#','.','.','.','.','#','#','.','.','.','#','#','#','#','#','.','.','.','#','#','#','.','.','#','.','#','.','#','#','#'],['.','#','.','#','#','#','#','.','.','.','#','.','#','#','#','.','#','#','.','.','#','#','.','#','.','#','.','#','#','.','#','#','.','#','#','#','#','.','.','#','#','#','#','.','#','#','#','.','#','#','#','#','#','#','#','.','.','#','#','.','.','.','#','.','.','#','#','#','.','.'],['.','.','.','.','.','#','#','.','.','.','.','.','.','#','.','#','.','#','#','.','#','#','#','#','#','#','.','.','.','.','#','.','#','.','#','.','#','#','#','#','#','.','#','#','.','#','.','#','#','.','.','.','#','.','#','.','.','#','#','#','.','#','.','#','.','#','#','#','.','.'],['.','#','.','#','#','.','#','.','#','.','#','#','.','.','#','#','#','.','#','.','.','#','.','.','.','#','#','#','#','#','.','.','#','#','.','.','#','.','#','#','#','#','#','.','.','.','#','.','.','.','.','#','.','.','#','.','#','.','.','.','#','.','#','#','.','#','.','.','.','.'],['.','#','#','#','#','.','.','.','#','.','.','.','.','#','.','#','.','#','#','.','#','.','#','#','.','#','#','#','#','.','.','.','.','.','.','#','.','.','.','.','.','.','#','#','#','.','.','.','.','#','#','#','#','.','.','.','.','.','#','#','#','#','#','#','#','.','.','.','.','#'],['.','#','#','#','.','.','.','#','#','#','#','#','#','#','#','.','#','#','.','#','.','.','#','.','#','.','.','.','#','.','#','#','.','.','#','#','#','#','.','#','#','.','#','#','#','#','#','.','#','.','.','#','.','#','.','.','.','.','#','#','.','.','.','#','.','.','.','#','#','.'],['#','.','.','#','#','#','.','.','#','#','#','#','.','#','.','.','.','.','#','.','#','.','.','#','#','#','#','#','.','#','#','.','#','.','#','#','.','.','.','#','.','#','.','#','#','#','.','#','#','#','.','#','.','#','.','.','.','.','#','#','#','.','.','.','#','.','#','#','.','#'],['#','#','#','.','.','#','.','#','#','#','.','#','.','#','#','#','#','#','.','#','#','#','.','.','.','.','#','#','#','.','.','#','.','.','.','#','#','.','#','#','#','.','#','.','.','#','#','.','#','#','#','#','.','#','.','#','.','#','.','#','#','#','.','.','.','#','#','.','#','.'],['.','#','#','#','#','#','.','#','.','.','#','#','.','.','#','.','.','.','#','.','#','#','.','#','.','.','#','#','.','#','.','#','.','#','.','.','.','#','#','.','#','#','.','.','#','#','#','#','.','.','#','.','#','#','.','.','.','.','.','.','.','.','.','#','.','.','#','#','.','#'],['.','#','.','#','#','#','.','.','.','#','.','.','.','.','#','.','#','#','.','#','#','#','#','#','#','.','.','#','.','.','.','#','#','.','#','.','.','.','#','#','#','.','#','#','.','.','.','#','#','#','.','.','.','#','#','#','#','#','#','#','#','.','.','#','.','#','.','#','#','#'],['.','#','#','#','#','#','#','.','#','.','.','.','#','#','.','#','#','#','#','.','#','#','.','.','#','.','.','#','.','.','.','#','.','#','.','.','#','#','.','#','#','.','#','.','#','#','.','#','.','#','.','#','.','#','#','.','#','.','#','#','#','.','.','#','#','.','#','#','.','#'],['#','.','.','.','#','#','#','#','.','#','.','#','.','.','#','#','.','#','.','.','.','#','#','.','#','.','#','.','.','.','#','#','.','#','.','.','.','.','.','.','#','#','#','#','.','.','.','#','.','.','#','.','.','.','.','#','#','.','#','#','.','.','#','.','#','#','#','.','#','.'],['#','.','.','.','.','#','#','.','.','#','.','#','#','.','.','.','.','#','#','#','#','#','#','#','.','#','.','.','.','#','.','.','#','.','#','#','#','#','.','#','#','.','.','.','.','.','#','#','#','.','#','#','#','#','.','#','.','#','#','#','.','.','#','.','.','#','#','#','#','.'],['.','.','#','#','.','.','#','#','.','#','.','.','.','.','#','#','#','#','#','#','#','#','.','.','#','.','#','#','.','.','.','.','.','.','.','#','.','.','.','#','.','#','.','.','.','.','.','.','.','.','.','#','#','.','#','.','#','.','.','#','.','.','.','.','#','#','#','#','.','.'],['.','#','.','.','#','#','.','#','.','#','.','#','#','.','.','.','#','.','.','.','.','.','#','#','.','.','.','#','#','.','#','.','#','.','.','.','#','.','.','.','.','#','.','.','#','#','#','#','#','.','#','.','.','#','.','.','#','.','#','#','#','.','.','#','.','#','.','#','#','#'],['#','.','#','#','.','#','#','.','.','.','.','.','.','.','.','.','.','.','.','#','#','.','#','#','.','.','.','.','.','#','#','.','#','.','.','.','#','.','#','.','.','#','#','.','.','#','.','#','.','.','#','#','#','.','.','.','.','.','#','.','.','#','.','.','#','.','.','#','.','#'],['.','.','#','.','.','.','.','.','#','.','.','#','.','.','#','.','#','.','.','.','.','.','#','.','.','.','#','#','#','.','#','.','#','.','.','#','.','.','.','.','#','#','.','#','#','.','.','.','#','.','.','.','#','#','.','#','#','.','.','.','.','#','.','.','#','#','.','.','.','#'],['.','.','#','#','.','.','.','#','#','.','#','#','.','.','.','.','.','.','#','.','.','.','#','.','.','#','#','#','#','#','.','.','.','.','#','.','.','#','.','.','.','.','.','.','#','#','#','.','#','.','.','#','#','#','#','#','.','.','.','#','#','#','#','.','#','.','.','.','.','#'],['#','.','.','#','#','#','.','#','#','.','.','#','#','#','#','.','#','.','.','.','.','#','.','.','#','#','.','#','.','.','#','#','.','#','#','.','#','.','#','.','.','#','#','#','#','#','#','.','.','.','.','.','.','.','.','.','#','.','#','#','.','.','.','.','#','#','#','#','#','#'],['.','.','#','.','#','#','#','#','#','#','.','#','.','#','#','.','.','.','#','.','.','#','#','#','#','.','.','#','#','.','.','.','.','#','#','.','.','#','#','#','.','#','.','#','#','#','.','#','.','#','.','.','#','.','#','#','.','#','#','.','#','#','#','.','#','.','.','#','.','#'],['.','.','#','.','#','#','#','#','.','#','#','#','.','#','.','#','.','.','#','#','#','.','.','#','#','#','#','#','#','#','.','#','.','.','#','#','.','#','.','.','.','.','#','.','#','#','#','#','#','.','#','#','#','.','.','.','.','#','.','#','.','.','#','#','#','.','.','.','#','#'],['.','.','.','.','#','.','.','.','.','#','.','.','#','#','#','.','#','.','.','.','#','.','.','.','.','.','.','#','.','.','#','#','.','.','.','#','#','.','.','#','#','.','#','.','#','#','#','.','.','.','#','#','#','.','#','.','#','.','#','.','#','.','.','#','.','.','.','#','.','#'],['#','.','.','.','.','#','.','.','#','#','.','.','#','#','.','#','#','#','.','#','#','#','#','.','#','#','#','#','#','#','#','.','#','#','#','.','#','#','#','.','.','.','#','.','.','.','#','.','.','#','#','#','.','.','.','#','.','.','.','#','.','#','.','.','#','.','#','#','.','#'],['#','.','.','.','#','#','#','.','#','#','.','.','#','.','#','.','.','#','.','#','.','.','#','.','#','.','#','.','.','#','#','#','.','.','#','#','#','#','.','#','#','.','#','#','.','#','.','.','.','#','#','#','.','#','.','#','#','#','#','#','#','#','#','#','#','#','.','.','.','#'],['#','#','.','.','.','#','.','.','.','#','.','.','.','#','.','.','#','#','.','.','.','.','#','.','.','.','#','.','.','.','#','.','.','.','.','#','#','#','.','#','#','#','#','#','#','#','.','.','.','.','.','#','.','#','.','#','#','.','.','.','#','#','.','.','#','.','#','.','.','#'],['.','.','.','.','.','#','#','.','#','#','.','#','.','#','.','#','.','.','#','.','.','#','#','#','.','.','.','.','#','#','.','#','.','.','.','.','#','#','#','#','.','#','.','#','#','.','#','#','#','#','.','.','#','.','#','#','.','#','.','.','#','#','.','#','#','.','#','#','#','.'],['.','.','.','.','#','#','.','#','.','.','.','.','#','#','#','#','#','.','#','.','#','#','.','.','.','.','.','.','.','.','.','#','#','.','#','#','#','#','#','#','.','#','.','.','#','#','#','.','.','#','#','#','.','.','#','.','#','.','#','#','.','#','#','#','.','.','.','.','.','#'],['.','.','.','#','#','.','.','#','#','#','#','#','.','.','.','.','#','#','.','.','#','#','#','#','.','.','.','.','#','#','.','.','#','#','#','.','#','#','.','#','#','.','.','#','#','.','.','.','#','.','#','.','#','#','#','.','#','.','#','.','#','#','.','#','.','#','#','.','.','.'],['.','.','#','.','.','#','#','#','#','.','#','.','.','#','.','#','#','.','#','#','.','#','.','.','#','#','#','#','.','.','#','.','#','.','.','.','#','#','.','.','.','.','.','#','.','.','.','#','.','.','.','.','#','#','#','.','.','#','.','#','.','#','#','.','.','#','.','#','#','.'],['#','#','#','#','#','.','#','.','.','#','.','#','.','#','#','#','.','.','#','.','#','.','#','#','#','.','#','#','#','#','#','#','#','.','#','.','#','.','.','.','#','.','.','.','.','.','.','.','.','#','#','.','.','#','.','.','.','#','.','#','#','.','.','#','.','#','#','.','#','.'],['.','#','.','.','#','#','#','.','#','#','#','.','#','.','.','#','#','.','#','#','#','#','.','#','#','.','#','#','#','.','.','.','#','.','.','#','.','#','.','.','.','.','.','#','.','#','.','#','.','.','.','#','.','.','.','.','#','.','#','#','#','.','.','#','#','.','#','.','#','.'],['.','#','.','#','.','.','.','.','.','#','#','.','#','#','.','#','.','#','#','#','#','.','.','#','#','.','#','.','#','.','.','.','#','.','#','.','.','#','.','.','.','.','.','#','.','.','#','.','.','.','.','#','.','.','.','.','.','.','#','.','#','#','#','#','#','#','.','#','#','.'],['.','.','.','#','#','.','#','#','.','.','#','.','.','.','.','#','#','#','.','.','.','#','.','.','#','.','#','.','.','#','.','#','.','#','.','#','#','.','.','#','#','.','#','.','.','#','.','#','#','#','#','.','.','#','#','#','#','.','#','.','#','.','.','.','.','.','.','.','.','.'],['#','.','#','#','#','.','#','.','.','.','#','.','.','.','.','#','.','.','.','#','.','#','#','#','.','.','.','.','.','#','.','.','#','.','.','.','#','#','.','#','.','#','.','#','#','#','#','.','.','#','.','.','.','#','.','#','.','#','.','.','#','#','#','#','.','.','.','.','.','.'],['#','#','.','#','#','#','.','#','.','#','#','#','#','#','.','#','.','#','#','.','.','.','.','#','.','.','#','.','.','#','#','.','.','#','#','.','.','#','.','.','#','#','.','.','#','#','.','.','.','#','.','#','.','#','#','.','#','#','.','.','.','.','#','.','.','.','#','#','.','.'],['.','#','#','#','.','.','#','#','#','.','.','.','.','#','.','.','.','#','#','.','.','#','#','#','.','.','#','.','.','.','.','#','#','#','.','.','.','.','.','#','.','.','#','#','.','.','.','#','#','#','.','#','#','#','.','#','#','#','.','.','#','#','.','#','.','.','#','#','#','#'],['#','.','#','#','#','.','.','.','.','.','.','.','.','#','.','.','#','#','.','#','.','.','.','.','.','#','.','.','.','.','.','#','.','.','.','#','#','.','#','#','#','#','#','.','#','.','#','#','.','.','#','#','.','.','.','.','#','#','#','#','.','#','.','.','.','#','#','.','#','.'],['#','.','#','.','#','.','.','#','#','#','.','#','#','.','#','#','#','.','.','#','#','#','.','.','#','#','.','.','#','#','#','#','#','#','.','.','#','#','.','#','#','#','#','#','.','.','.','.','.','.','#','.','#','#','.','.','.','.','#','#','.','#','.','.','#','#','#','.','#','.'],['#','#','#','.','.','.','#','#','.','#','.','#','.','#','.','#','.','#','.','#','#','#','#','#','#','.','.','.','#','.','.','#','#','.','.','.','.','.','#','.','#','#','#','#','#','#','#','.','#','.','.','#','.','.','#','#','#','.','#','.','#','#','#','.','#','.','.','.','#','.'],['#','#','#','.','.','#','#','#','#','#','#','.','.','.','.','.','.','#','.','#','#','#','.','.','#','.','.','.','.','.','#','#','#','#','#','#','#','#','#','.','.','.','.','#','#','#','#','#','.','#','#','.','.','#','.','.','.','#','.','#','.','.','.','#','#','#','.','.','#','#'],['#','#','.','#','.','.','#','#','#','#','#','#','.','.','#','.','#','#','#','.','.','#','.','#','#','#','.','#','#','#','.','#','.','#','#','#','#','#','.','#','#','#','#','.','.','.','.','.','#','.','.','.','#','.','#','.','.','.','#','#','#','#','#','.','#','.','.','#','#','.'],['.','.','.','#','#','#','#','.','#','.','#','#','#','#','#','.','#','#','.','.','.','#','#','.','.','#','.','#','#','#','#','#','#','.','#','#','#','.','.','.','.','#','.','#','#','#','.','#','.','#','#','.','#','#','#','#','#','.','.','.','#','.','#','.','#','.','#','#','#','#'],['#','.','.','#','#','#','.','#','#','#','#','#','#','#','#','.','#','.','#','#','#','.','#','.','#','#','#','#','.','#','#','#','.','#','#','#','.','#','.','.','#','.','#','#','.','#','.','#','#','#','#','#','.','.','#','#','#','#','.','#','.','#','#','#','.','.','.','#','#','#'],['#','.','.','#','.','.','.','.','.','#','.','#','#','#','.','#','.','#','#','.','#','#','#','.','#','.','.','.','.','.','#','.','.','#','.','.','.','.','#','#','#','#','#','.','#','.','#','.','.','.','#','#','.','#','#','#','.','#','#','#','#','#','#','.','#','#','#','.','#','#'],['#','#','.','#','.','#','.','.','.','#','#','#','.','#','.','#','.','.','#','.','#','.','#','#','#','.','.','.','.','#','#','#','.','.','#','.','#','#','.','#','.','.','#','.','.','#','#','#','.','#','.','.','#','#','#','#','#','#','#','.','#','#','.','#','#','#','.','#','#','#'],['.','#','#','.','.','#','#','.','#','.','.','#','.','#','#','#','#','#','.','#','#','#','.','#','.','#','.','#','.','.','.','.','.','.','#','.','#','.','#','#','.','#','.','.','.','#','.','#','#','#','#','#','#','.','#','#','.','.','.','#','.','#','#','#','.','#','#','#','#','#'],['#','#','#','#','#','.','.','.','.','#','.','#','#','.','.','.','.','#','#','.','#','#','#','.','.','#','.','#','#','#','.','.','#','#','#','.','#','#','.','.','.','#','#','#','#','.','#','#','#','.','#','#','#','.','.','#','#','.','#','#','#','#','.','#','.','#','#','.','#','#'],['#','.','.','.','.','.','.','#','.','#','#','.','#','#','.','#','#','.','#','.','.','.','.','#','.','#','#','.','#','#','.','.','#','#','#','#','#','#','#','#','.','#','.','.','.','.','#','.','.','#','.','.','#','#','#','.','#','#','#','#','#','.','#','.','#','.','.','#','#','.'],['.','#','.','.','#','.','.','.','#','.','.','#','#','.','#','.','.','#','#','#','.','.','.','#','.','.','.','.','.','.','#','#','.','#','#','.','#','#','#','.','.','.','.','.','#','.','#','.','#','.','#','.','.','#','.','#','#','#','#','#','.','#','#','.','.','#','.','#','#','#'],['.','#','#','.','#','#','.','#','.','#','#','.','#','#','#','.','.','#','.','.','#','#','.','#','#','#','#','.','#','.','#','.','.','#','#','#','#','.','#','.','#','.','.','.','.','.','.','.','#','#','.','.','.','.','.','.','.','#','#','.','.','.','.','.','#','#','#','#','#','.'],['#','#','#','#','.','.','.','#','#','.','.','.','#','.','#','.','#','.','.','#','#','#','.','#','#','#','#','#','.','#','.','#','.','#','.','#','#','.','#','.','.','#','#','.','.','.','.','.','.','#','.','#','#','#','.','#','#','.','.','#','.','.','.','#','.','.','.','#','.','#'],['.','.','.','.','.','.','.','.','.','.','.','#','#','.','#','.','#','#','#','#','.','#','.','#','#','#','#','#','#','#','#','#','.','.','#','#','#','.','.','.','.','#','.','.','.','#','.','.','.','.','.','.','.','#','.','.','#','#','#','#','.','.','#','#','#','#','#','.','#','.'],['.','#','.','#','#','#','.','#','#','.','#','.','.','#','#','#','#','.','.','#','.','#','#','#','.','#','.','#','#','#','#','#','.','.','#','#','.','#','.','.','.','.','.','.','#','.','#','.','.','#','#','#','#','#','.','#','#','.','#','.','#','#','#','.','#','.','#','#','.','#'],['#','#','#','.','.','#','.','.','.','#','.','#','#','.','#','#','#','#','.','#','.','#','#','.','.','.','#','.','.','#','.','.','.','.','.','.','.','#','#','#','#','#','#','.','.','.','#','.','.','.','.','#','#','.','.','.','.','#','.','.','.','.','.','#','.','.','.','#','.','.'],['#','#','#','#','.','#','.','#','.','.','.','#','.','#','.','#','#','#','#','#','#','#','.','#','#','.','.','.','#','.','.','#','.','#','.','.','#','#','#','#','#','.','.','.','#','.','.','#','.','#','.','.','#','#','.','#','#','.','.','.','.','.','#','#','.','#','#','.','#','.'],['#','#','#','.','.','#','#','.','.','#','.','.','#','.','#','.','#','#','.','#','#','.','.','#','.','.','#','#','.','.','#','#','.','.','#','#','#','#','#','.','#','.','#','#','.','.','#','#','.','#','#','#','#','.','#','#','.','#','#','.','.','.','#','.','#','#','#','#','.','#'],['#','.','#','#','.','#','.','#','.','.','#','#','.','.','#','#','#','#','.','.','.','.','.','#','.','#','#','#','.','.','#','.','.','.','.','#','#','#','.','#','.','#','#','.','#','#','#','.','#','.','#','.','#','.','#','#','#','#','#','#','.','#','#','.','.','.','.','#','.','.'],['.','#','.','#','.','.','#','#','.','.','#','.','#','#','#','.','#','.','.','.','.','.','#','#','.','#','#','.','.','#','#','.','.','.','.','#','#','#','#','.','.','#','.','#','.','.','#','.','.','#','#','#','#','#','#','#','#','#','#','.','#','.','.','.','#','.','.','.','#','.'],['#','#','#','.','#','#','#','#','.','#','.','#','.','#','#','.','#','.','.','.','.','.','.','#','.','#','#','#','.','.','.','.','.','.','#','#','.','#','#','#','.','.','#','#','.','#','#','.','#','.','.','#','.','.','.','.','#','.','#','#','.','#','.','.','#','.','.','.','.','.'],['.','.','.','.','.','#','#','.','.','.','.','.','.','.','#','#','#','.','#','.','.','#','#','#','#','.','#','.','#','.','#','.','#','#','#','.','.','#','#','.','.','.','#','#','.','.','.','#','#','#','#','.','#','.','#','#','.','#','.','#','.','#','.','.','#','.','#','.','#','#'],['.','.','#','#','.','#','#','.','#','.','.','#','.','#','#','.','.','.','.','.','#','.','.','.','#','#','.','#','.','.','.','#','.','#','#','#','.','.','#','#','.','#','.','#','#','.','.','.','#','.','.','#','.','.','.','.','.','#','#','#','.','#','.','#','#','#','#','#','.','.']];

// const input = [['.','.','.','.','#','.','.'],['.','.','#','#','#','.','#'],['#','.','.','.','#','.','#'],['.','#','.','.','.','#','#'],['#','.','#','#','#','.','.'],['#','#','.','#','.','#','#'],['.','#','.','.','#','.','.']];

const mapElves = () => {
    const map = {};
    for (let row=0;row<input.length;row++){
        for (col=0;col<input[row].length;col++){
            if (input[row][col] === '#') map[`${col},${row}`] = 1;
        }
    }
    return map;
};

const directions = [
    [0,-1], [-1,-1], [1,-1], // N, NE, NW
    [0, 1], [1,1], [-1,1], // S, SE, SW
    [-1,0], [-1,-1], [-1,1], //W, NW, SW
    [1,0], [1,1], [1,-1] // E, NE, SE
];

const rotateDirections = (dir) => {
    for (i=0;i<3;i++) dir.push(dir.splice(0,1)[0]); // <3 it's a love-heart!!!
};

const drawMap = (map) => {
    let minX = Infinity;
    let minY = Infinity;
    let maxX = -Infinity;
    let maxY = -Infinity;
    for (const c of Object.keys(map)){
        const [x, y] = c.split(',').map(e => parseInt(e, 10));
        if (x < minX) minX = x;
        if (x > maxX) maxX = x;
        if (y < minY) minY = y;
        if (y > maxY) maxY = y;
    }

    const lines = [];
    let count = 0;
    for (let x=minX;x<=maxX;x++){
        let line = '';
        for (let y=minY;y<=maxY;y++){
            if (map[`${x},${y}`]){
                line += '#';
            } else {
                line += '.';
                count++;
            }
        }
        lines.push(line);
    }

    for (const line of lines) console.log(line);
    return count;
};

const simulateRounds = (map) => {
    let moves = 0;
    while (true){ // danger! DANGER!!!
        const proposed = {};

        let elvesMoved = false;
        for (const elf of Object.keys(map)){
            const [x, y] = elf.split(',').map(e => parseInt(e, 10));
            const otherDirs = directions.map(([xD, yD]) => [x+xD, y+yD]); // 4 extra passes, but that's nbd
            if (!otherDirs.every(e => !map[e.toString()])){
                // need to try move proposal
                for (let i=0;i<directions.length;i+=3){
                    const dirs = directions.slice(i, i+3).map(([xD,yD]) => [x+xD, y+yD]);
                    if (dirs.every(e => !map[e.toString()])){
                        // dirs[0] is our proposal
                        if (!proposed[dirs[0].toString()]){
                            // all good so far
                            proposed[dirs[0].toString()] = {
                                canMove: true,
                                from: `${x},${y}`,
                            };
                        } else {
                            // somebody else wants to go here, as well
                            proposed[dirs[0].toString()].canMove = false;
                        }
                        break;
                    }
                }
            }
        }

        // do proposed moves that are valid
        for (const [newLocation, p] of Object.entries(proposed).filter(([k,v]) => v.canMove)){
            elvesMoved = true;
            delete map[p.from]; // elfy boi isn't there anymore
            map[newLocation] = 1;
        }
        moves++;
        if (!elvesMoved) break;
        rotateDirections(directions);
    }

    return moves;
};

console.log(simulateRounds(mapElves()));